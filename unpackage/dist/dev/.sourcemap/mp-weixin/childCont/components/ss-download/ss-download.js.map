{"version":3,"sources":["webpack:///F:/G/company/umi-git/childCont/components/ss-download/ss-download.vue?b7cd","webpack:///F:/G/company/umi-git/childCont/components/ss-download/ss-download.vue?bd0a","webpack:///F:/G/company/umi-git/childCont/components/ss-download/ss-download.vue?6b40","webpack:///F:/G/company/umi-git/childCont/components/ss-download/ss-download.vue?3866","uni-app:///childCont/components/ss-download/ss-download.vue"],"names":["name","props","fileUrl","type","default","fileType","data","methods","toDownload","downloadH5","uni","mask","title","url","success","oA","document","saveFile","tempFilePath","filePath","showMenu","fail","console","getDownVideo","icon","fileMgr","complete","task","onProgress","saveToPhotosAlbum","statusCode","res","showLoading","saveFileToApp","duration","convertLocalFileSystemURL","filename","plus","dtask","prg","watch","deep","handler","src"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwH;AACxH;AAC+D;AACL;;;AAG1D;AAC4M;AAC5M,gBAAgB,gNAAU;AAC1B,EAAE,iFAAM;AACR,EAAE,sFAAM;AACR,EAAE,+FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,0FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAqzB,CAAgB,oyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;eCKz0B;EACAA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;IACA;EACA;EACAE;IACA;EACA;EACAC;IACAC;MAKA;QACA;MACA;QACA;MACA;QACA;MACA;IAKA;IACA;IACAC;MACAC;QACAC;QACAC;MACA;MACAF;QACAG;QAAA;QACAC;UACA;UACA;YACA;YACA;YACAC;YACAA;YACAC;YACAD;YACAA;YACAL;UACA;YACAA;UACA;QACA;MACA;IACA;IACA;IACAO;MACAP;MACAA;QAAA;QACAG;QAAA;QACAC;UACA;UACA;UACAJ;YACAQ;YACAJ;cACA;cACAJ;gBACAS;gBACAd;gBACAe;gBACAN;kBACAJ;gBACA;gBACAW;kBACAX;gBACA;cACA;YACA;YACAW;cACAC;cACAZ;cACAY;YACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACAb;QACAC;QACAC;MACA;MACA;MACA;QACAC;QACAM;QAAA;QACAL;UACA;UACAJ;YACAS;YACAL;cACAJ;gBACAE;gBACAY;cACA;cACA;cACA;cACAC;gBACAN,mDACA;gBACAL;kBACAQ;kBACAA;gBACA;cACA;YACA;YACAD;cACAX;gBACAE;gBACAY;cACA;YACA;YACAE;cACAJ;cACAA;cACAZ;YACA;UACA;QACA;QACAW;UACAX;YACAE;YACAY;UACA;QACA;QACAE;UACAJ;UACAA;QACA;MACA;MACAK;IACA;IACA;IACAC;MACAlB;QACAC;QACAC;MACA;IACA;IACA;IACAiB;MAIA;QACAhB;QACAC;UACA,IACAgB,aAEAC,IAFAD;YACAZ,eACAa,IADAb;UAEA;YAAA;YACAR;cAAA;cACAS;cACAL;gBACAQ;gBACAZ;kBACAE;kBACAY;gBACA;cACA;cACAE,kCAIA;YACA;UACA;YACAhB;cACAE;cACAY;YACA;UAIA;QACA;QACAE,+BAEA;MACA;MACAC;QACA;QACA;QACA;QACAK;MACA;IACA;IACA;IACAC;MACA,oDACA;QACAvB;UACAE;UACAD;UACAuB;QACA;QACA;QACA;QACAZ;QACA;UACAA;UACAA,wEACAa,4BACAC;UACAC;YACAf;UACA;YACAA;UACA;QACA;UACAZ;YACAE;YACAD;YACAuB;UACA;QACA;MACA;MACA;QACAI;QACA;QACA;QACAA;UACA;UACA;YACA;cACAN;cACA;YACA;cACAA;cACA;YACA;cACAO;cACAP;cACA;YACA;cACAK;cACA;cACA;UAAA;QAEA;MACA;QACAA;QACA3B;UACAE;UACAD;UACAuB;QACA;MACA;IACA;EAEA;EACAM;IACAnC;MACAoC;MACAC;QACA;UACA;YACAvC;YACAwC;UACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B","file":"childCont/components/ss-download/ss-download.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./ss-download.vue?vue&type=template&id=171f47f1&\"\nvar renderjs\nimport script from \"./ss-download.vue?vue&type=script&lang=js&\"\nexport * from \"./ss-download.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"childCont/components/ss-download/ss-download.vue\"\nexport default component.exports","export * from \"-!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ss-download.vue?vue&type=template&id=171f47f1&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ss-download.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Ksoftware/HBuilderX.3.7.9.20230324/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ss-download.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view></view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tname: 'ss-download',\r\n\t\tprops: {\r\n\t\t\tfileUrl: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\tfileType: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '', //1.预览图片，2.预览文件，3.预览视频\r\n\t\t\t},\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\ttoDownload(item) {\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\tthis.downloadH5(item.src)\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tif(item.type == 1){\r\n\t\t\t\t\tthis.saveToPhotosAlbum(item.src)\r\n\t\t\t\t} else if (item.type == 2) {\r\n\t\t\t\t\tthis.saveFile(item.src)\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.getDownVideo(item.src)\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tthis.saveFileToApp(item.src)\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\t//H5下载图片到本地\r\n\t\t\tdownloadH5(url) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\ttitle: '下载中...'\r\n\t\t\t\t})\r\n\t\t\t\tuni.downloadFile({\r\n\t\t\t\t\turl: url, //仅为示例，并非真实的资源\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\t\t// console.log('下载成功');\r\n\t\t\t\t\t\t\tvar oA = document.createElement(\"a\");\r\n\t\t\t\t\t\t\toA.download = ''; // 设置下载的文件名，默认是'下载'\r\n\t\t\t\t\t\t\toA.href = res.tempFilePath; //临时路径再保存到本地\r\n\t\t\t\t\t\t\tdocument.body.appendChild(oA);\r\n\t\t\t\t\t\t\toA.click();\r\n\t\t\t\t\t\t\toA.remove(); // 下载之后把创建的元素删除\r\n\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//微信小程序保存文档,不支持h5\r\n\t\t\tsaveFile(url) {\r\n\t\t\t\tuni.showLoading()\r\n\t\t\t\tuni.downloadFile({ //下载文件资源到本地,返回文件的本地临时路径\r\n\t\t\t\t\turl: url, //网络图片路径\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tvar filePath = res.tempFilePath;\r\n\t\t\t\t\t\t//保存到本地\r\n\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\ttempFilePath: filePath,\r\n\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t//res.savedFilePath文件的保存路径\r\n\t\t\t\t\t\t\t\tuni.openDocument({\r\n\t\t\t\t\t\t\t\t\tfilePath: res.savedFilePath,\r\n\t\t\t\t\t\t\t\t\tfileType: 'pdf',\r\n\t\t\t\t\t\t\t\t\tshowMenu: true,\r\n\t\t\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t\tconsole.log('保存失败')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//微信小程序保存视频\r\n\t\t\tgetDownVideo(url) {\r\n\t\t\t\t// 自定义 文件名称\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\ttitle: '下载中...'\r\n\t\t\t\t})\r\n\t\t\t\tlet fileName = new Date().valueOf();\r\n\t\t\t\tconst task = uni.downloadFile({\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\tfilePath: wx.env.USER_DATA_PATH + '/' + fileName + '.mp4', //  拼接本地文件路径\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tlet filePath = res.filePath\r\n\t\t\t\t\t\tuni.saveVideoToPhotosAlbum({\r\n\t\t\t\t\t\t\tfilePath,\r\n\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '下载成功',\r\n\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tlet fileMgr = wx.getFileSystemManager();\r\n\t\t\t\t\t\t\t\t// 删除本地文件\r\n\t\t\t\t\t\t\t\tfileMgr.unlink({\r\n\t\t\t\t\t\t\t\t\tfilePath: wx.env.USER_DATA_PATH + '/' + fileName +\r\n\t\t\t\t\t\t\t\t\t\t'.mp4',\r\n\t\t\t\t\t\t\t\t\tsuccess: function(r) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('unlink-getFileSystemManager')\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(r)\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '保存失败',\r\n\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcomplete(res) {\r\n\t\t\t\t\t\t\t\tconsole.log('saveVideoToPhotosAlbum-complete')\r\n\t\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '下载失败,请稍后再试',\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete(res) {\r\n\t\t\t\t\t\tconsole.log('downloadFiledownloadFiledownloadFiledownloadFiledownloadFile')\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ttask.onProgressUpdate(this.onProgress)\r\n\t\t\t},\r\n\t\t\t// 提示下载进度\r\n\t\t\tonProgress(res) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\ttitle: res.progress ? '下载中' + res.progress + \"%\" : '下载中...'\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//微信小程序保存图片（此处也可用于app保存图片或视频）\r\n\t\t\tsaveToPhotosAlbum(url) {\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tvar showLoading = plus.nativeUI.showWaiting(\"正在下载\"); //创建一个showWaiting对象 \r\n\t\t\t\t// #endif\r\n\t\t\t\tlet task = uni.downloadFile({\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\tstatusCode,\r\n\t\t\t\t\t\t\ttempFilePath\r\n\t\t\t\t\t\t} = res\r\n\t\t\t\t\t\tif (statusCode === 200) { // saveImageToPhotosAlbum  saveVideoToPhotosAlbum  \r\n\t\t\t\t\t\t\tuni.saveImageToPhotosAlbum({ //此处也可用saveVideoToPhotosAlbum\r\n\t\t\t\t\t\t\t\tfilePath: tempFilePath,\r\n\t\t\t\t\t\t\t\tsuccess: data => {\r\n\t\t\t\t\t\t\t\t\tconsole.log('data----------------->', data)\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '下载成功,文件已保存到' + data.path,\r\n\t\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcomplete: (msg) => {\r\n\t\t\t\t\t\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t\t\t\t\t\tplus.nativeUI.closeWaiting()\r\n\t\t\t\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '下载失败',\r\n\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t\t\t\tplus.nativeUI.closeWaiting()\r\n\t\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ttask.onProgressUpdate((res => {\r\n\t\t\t\t\t// console.log('上传进度' + res.progress);\r\n\t\t\t\t\t// console.log('已经上传的数据长度' + res.totalBytesSent);\r\n\t\t\t\t\t// console.log('预期需要上传的数据总长度' + res.totalBytesExpectedToSend);\r\n\t\t\t\t\tshowLoading.setTitle(\"  正在下载\" + res.progress + \"%  \");\r\n\t\t\t\t}))\r\n\t\t\t},\r\n\t\t\t//移动端下载文件\r\n\t\t\tsaveFileToApp(url){\r\n\t\t\t\tvar dtask = plus.downloader.createDownload(url, {},\r\n\t\t\t\t\tfunction(d, status) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '下载完成',\r\n\t\t\t\t\t\t\tmask: false,\r\n\t\t\t\t\t\t\tduration: 1000\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//console.log(dtask);\r\n\t\t\t\t\t\t// 下载完成\r\n\t\t\t\t\t\tconsole.log('status: ' + status);\r\n\t\t\t\t\t\tif (status == 200) {\r\n\t\t\t\t\t\t\tconsole.log('下载成功：' + d.filename);\r\n\t\t\t\t\t\t\tconsole.log('plus.io.convertLocalFileSystemURL(d.filename): ' + plus.io\r\n\t\t\t\t\t\t\t\t.convertLocalFileSystemURL(d\r\n\t\t\t\t\t\t\t\t\t.filename))\r\n\t\t\t\t\t\t\tplus.runtime.openFile(plus.io.convertLocalFileSystemURL(d.filename), {}, function(success) {\r\n\t\t\t\t\t\t\t\tconsole.log('打开成功')\r\n\t\t\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\t\t\tconsole.log('打开失败')\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '下载失败-02',\r\n\t\t\t\t\t\t\t\tmask: false,\r\n\t\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdtask.start(); // 开启下载的任务\r\n\t\t\t\t\tvar prg = 0;\r\n\t\t\t\t\tvar showLoading = plus.nativeUI.showWaiting(\"正在下载\"); //创建一个showWaiting对象 \r\n\t\t\t\t\tdtask.addEventListener('statechanged', function(task, status) {\r\n\t\t\t\t\t\t// 给下载任务设置一个监听 并根据状态  做操作\r\n\t\t\t\t\t\tswitch (task.state) {\r\n\t\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\t\tshowLoading.setTitle(\"正在下载\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\tshowLoading.setTitle(\"已连接到服务器\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\tprg = parseInt((parseFloat(task.downloadedSize) / parseFloat(task.totalSize)) * 100);\r\n\t\t\t\t\t\t\t\tshowLoading.setTitle(\"  正在下载\" + prg + \"%  \");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\tplus.nativeUI.closeWaiting();\r\n\t\t\t\t\t\t\t\t//下载完成\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tplus.nativeUI.closeWaiting();\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '更新失败-03',\r\n\t\t\t\t\t\tmask: false,\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tfileType: {\r\n\t\t\t\tdeep: true,\r\n\t\t\t\thandler: function(value) {\r\n\t\t\t\t\tif(this.fileUrl){\r\n\t\t\t\t\t\tthis.toDownload({\r\n\t\t\t\t\t\t\ttype:this.fileType,\r\n\t\t\t\t\t\t\tsrc:this.fileUrl,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n"],"sourceRoot":""}